<ion-content>
  <!-- Bagian Profile Top -->
  <div class="profile-top">
    <div class="profile-header-icons">
      <ion-icon name="arrow-back-outline" class="back-btn" (click)="goBack()"></ion-icon>
      <ion-icon name="key-outline" class="key-btn" routerLink="/password"></ion-icon>
    </div>

    <div class="profile-top-container">
      <div class="profile-photo" (click)="openProfileModal()">
        <img [src]="user.foto || DEFAULT_FOTO" alt="Foto profil pengguna" />
      </div>

      <div class="profile-nik-side">
        <h2 class="profile-name">{{ user.nama }}</h2>
        <p class="profile-nik">{{ user.nik }}</p>
      </div>
    </div>
  </div>

  <!-- Form Profile -->
  <div class="profile-box">
    <ion-item class="input-box">
      <ion-icon name="person-outline" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.nama" placeholder="Nama Lengkap" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <ion-item class="input-box">
      <ion-icon name="card-outline" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.nik" placeholder="NIK" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <ion-item class="input-box">
      <ion-icon name="mail-outline" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.email" type="email" placeholder="Email" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <ion-item class="input-box">
      <ion-icon name="logo-whatsapp" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.whatsapp" type="text" placeholder="No WhatsApp" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <ion-item class="input-box">
      <ion-icon name="call-outline" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.phone" type="text" placeholder="No Telepon" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <ion-item class="input-box">
      <ion-icon name="location-outline" slot="start"></ion-icon>
      <ion-input [(ngModel)]="user.address" type="text" placeholder="Alamat Lengkap" [readonly]="!isEditing"></ion-input>
    </ion-item>

    <!-- Upload Foto -->
    <div class="foto-row">
      <ion-item class="foto-item">
        <ion-label position="stacked">Foto Anda:</ion-label>
        <div class="foto-box" (click)="pickImage()">
          <ion-icon name="camera-outline"></ion-icon>
          <span>Upload</span>
        </div>
      </ion-item>

      <div class="circle-btn-wrapper">
        <ion-fab-button class="circle-btn save-btn" (click)="saveProfile()">
          <ion-icon name="save-outline"></ion-icon>
        </ion-fab-button>
        <ion-fab-button class="circle-btn edit-btn" (click)="enableEdit()">
          <ion-icon name="create-outline"></ion-icon>
        </ion-fab-button>
      </div>
    </div>
  </div>

  <!-- Logout -->
  <div class="logout-btn-wrapper">
    <ion-button expand="block" color="danger" (click)="logout()">
      <ion-icon name="log-out-outline" slot="start"></ion-icon>
      Logout
    </ion-button>
  </div>

  <!-- Modal Preview Foto -->
  <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeProfileModal()" cssClass="photo-modal">
    <ng-template>
      <div class="photo-viewer">
        <ion-img [src]="user.foto || DEFAULT_FOTO" class="photo-img"></ion-img>
        <ion-button fill="clear" class="close-btn" (click)="closeProfileModal()">
          <ion-icon name="close" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
    </ng-template>
  </ion-modal>
</ion-content>
